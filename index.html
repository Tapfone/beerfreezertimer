<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beer Freezer Timer</title>
    <!-- Load Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles to enforce mobile aspect ratio and background */
        body {
            background-color: #1e3a8a; /* Dark Blue Background */
            color: white;
            font-family: 'Inter', sans-serif;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
        }

        /* Container for the 9:16 mobile look */
        .mobile-container {
            width: 100%;
            max-width: 400px; /* Max width typical of a large phone */
            height: 100vh;
            max-height: 900px; /* Max height to maintain ratio */
            background-color: #1e3a8a; /* Blue-900 */
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
            border-radius: 0; /* Keep it full screen if on a small device, or simple card if on desktop */
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            position: relative;
        }

        @media (min-width: 640px) {
            .mobile-container {
                border-radius: 1.5rem; /* Rounded corners for desktop view */
                margin-top: 1rem;
                margin-bottom: 1rem;
            }
        }

        /* Keyframe for button press feedback */
        .btn-press:active {
            transform: scale(0.98);
        }

        /* Styles for the instruction section */
        #instructions-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        #instructions-content.open {
            max-height: 1000px; /* Sufficiently large value for smooth transition */
            transition: max-height 0.5s ease-in;
        }
        .instruction-step {
            list-style-type: none;
            counter-increment: step-counter;
            padding-left: 2rem;
            position: relative;
            margin-bottom: 1rem;
        }
        .instruction-step::before {
            content: "Step " counter(step-counter) ":";
            position: absolute;
            left: 0;
            font-weight: bold;
            color: #60a5fa; /* Blue-400 */
        }
    </style>
</head>
<body>

    <div class="mobile-container p-6">
        <header class="text-center mb-6">
            <h1 class="text-4xl font-extrabold tracking-tight">
                üç∫ Beer Freezer Timer ‚ùÑÔ∏è
            </h1>
            <p class="text-blue-300 mt-1">Perfect Chill: 20 Minutes</p>
        </header>

        <!-- Timer Display Area -->
        <div id="timer-display" class="flex-grow flex items-center justify-center">
            <div id="countdown" class="text-8xl font-mono font-bold tracking-wider text-white select-none transition-colors duration-500">
                20:00
            </div>
            <div id="alarm-message" class="text-center hidden">
                <p class="text-6xl font-black text-yellow-300 animate-pulse">
                    ENJOY YOUR BEER!
                </p>
                <p class="text-2xl mt-4">Operation Ice-Cold Brew Complete.</p>
            </div>
        </div>

        <!-- Controls -->
        <div class="flex justify-center space-x-4 mb-8">
            <button id="start-btn" class="btn-press bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-8 rounded-full shadow-lg transition-all text-xl disabled:opacity-50" onclick="startTimer()">
                Start
            </button>
            <button id="reset-btn" class="btn-press bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-8 rounded-full shadow-lg transition-all text-xl disabled:opacity-50" onclick="resetTimer()" disabled>
                Reset
            </button>
        </div>

        <!-- Instructions Section -->
        <div class="bg-blue-800 p-4 rounded-xl shadow-inner mb-4">
            <button id="instructions-toggle" class="w-full text-left font-semibold text-lg flex justify-between items-center" onclick="toggleInstructions()">
                Instructions
                <span id="toggle-icon">‚ñº</span>
            </button>
            <div id="instructions-content" class="mt-3 text-sm text-blue-100">
                <ol>
                    <li class="instruction-step">
                        <span class="font-medium">The Mission:</span> Open your freezer like you‚Äôre entering a top-secret vault. Whisper to yourself: ‚ÄúOperation Ice-Cold Brew begins now.‚Äù
                    </li>
                    <li class="instruction-step">
                        <span class="font-medium">Clear Space:</span> Move aside the frozen pizza, month-old mystery Tupperware, and that bag of peas you definitely never use. Your beer deserves VIP freezer real estate.
                    </li>
                    <li class="instruction-step">
                        <span class="font-medium">Place the Beer:</span> Gently lay your beer in the freezer like it‚Äôs a newborn baby from a brewery. Do NOT just toss it in‚Äîthis is beer, not a grenade.
                    </li>
                    <li class="instruction-step">
                        <span class="font-medium">Set the Timer:</span> This is the most important part. Press **start** on the timer. Because if you don‚Äôt, you will 100% forget about it until it becomes a sad, frozen beer-slush explosion.
                    </li>
                    <li class="instruction-step">
                        <span class="font-medium">Walk Away Confidently:</span> Close the freezer door. Pat yourself on the back. Say ‚ÄúI am responsible. I will not forget.‚Äù (This is a lie. But try.)
                    </li>
                    <li class="instruction-step">
                        <span class="font-medium">Fight the URGE:</span> Do not open the freezer to ‚Äújust check.‚Äù You‚Äôre not inspecting a souffl√©. Let the cold do its magic.
                    </li>
                    <li class="instruction-step">
                        <span class="font-medium">Retrieve on Time:</span> When the timer goes off, sprint back like it‚Äôs the Olympic finals. Open the freezer and retrieve your perfectly chilled masterpiece. If you forgot the timer‚Ä¶ well, enjoy your Beer-Flavored Slushie!
                    </li>
                    <li class="instruction-step">
                        <span class="font-medium">Celebrate:</span> Crack open the beer. Take a sip. Congratulations‚Äîyou have achieved Peak Refreshment!
                    </li>
                </ol>
            </div>
        </div>

    </div>

    <script>
        const INITIAL_TIME_SECONDS = 20 * 60; // 1200 seconds for 20 minutes
        let totalSeconds = INITIAL_TIME_SECONDS;
        let interval = null;
        let isRunning = false;

        const countdownEl = document.getElementById('countdown');
        const startBtn = document.getElementById('start-btn');
        const resetBtn = document.getElementById('reset-btn');
        const alarmMessageEl = document.getElementById('alarm-message');
        const timerDisplayEl = document.getElementById('timer-display');
        const instructionsContent = document.getElementById('instructions-content');
        const toggleIcon = document.getElementById('toggle-icon');

        /**
         * Converts total seconds into MM:SS format.
         * @param {number} seconds - The total seconds remaining.
         */
        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = seconds % 60;
            return `${String(minutes).padStart(2, '0')}:${String(remainingSeconds).padStart(2, '0')}`;
        }

        /**
         * Updates the timer display element.
         */
        function updateDisplay() {
            countdownEl.textContent = formatTime(totalSeconds);

            if (totalSeconds <= 60 && totalSeconds > 0) {
                // Change to orange for the last minute warning
                countdownEl.classList.add('text-orange-400');
                countdownEl.classList.remove('text-white');
            } else {
                countdownEl.classList.remove('text-orange-400');
                countdownEl.classList.add('text-white');
            }
        }

        /**
         * Generates and plays a short alarm tone using the Web Audio API.
         */
        function playAlarm() {
            try {
                // Simple sine wave tone
                const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioCtx.createOscillator();
                const gainNode = audioCtx.createGain();

                oscillator.connect(gainNode);
                gainNode.connect(audioCtx.destination);

                oscillator.type = 'sine';
                oscillator.frequency.setValueAtTime(440, audioCtx.currentTime); // 440 Hz (A4)
                gainNode.gain.setValueAtTime(0, audioCtx.currentTime);
                // Ramp up volume
                gainNode.gain.linearRampToValueAtTime(0.3, audioCtx.currentTime + 0.05);
                // Ramp down volume for a short blip
                gainNode.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 0.5);

                oscillator.start();
                setTimeout(() => oscillator.stop(), 500); // Play for half a second
            } catch (e) {
                console.warn("Audio playback failed (AudioContext unavailable or blocked):", e);
                // Fail silently if audio API is blocked by browser policy
            }
        }

        /**
         * Logic to run when the timer reaches zero.
         */
        function timerComplete() {
            clearInterval(interval);
            isRunning = false;
            
            // Play the alarm
            playAlarm();

            // Switch to the success message display
            countdownEl.style.display = 'none';
            alarmMessageEl.style.display = 'flex';
            alarmMessageEl.classList.add('flex-col', 'items-center', 'justify-center', 'w-full', 'h-full');

            // Update button states
            startBtn.textContent = 'Start';
            startBtn.disabled = true;
            resetBtn.disabled = false;
        }

        /**
         * Main countdown logic executed every second.
         */
        function countdownLogic() {
            if (totalSeconds <= 0) {
                timerComplete();
                return;
            }

            totalSeconds--;
            updateDisplay();
        }

        /**
         * Starts or pauses the timer.
         */
        function startTimer() {
            // Must attempt to start the alarm sound to unblock audio on mobile devices
            // if audio is blocked by security policy, this initial attempt might fail
            if (!isRunning) {
                playAlarm(); // Attempt to unblock audio context on first click

                // If timer is at zero, reset it first before starting
                if (totalSeconds <= 0) {
                    resetTimer();
                }

                interval = setInterval(countdownLogic, 1000);
                isRunning = true;
                startBtn.textContent = 'Pause';
                resetBtn.disabled = false;
                alarmMessageEl.style.display = 'none';
                countdownEl.style.display = 'block';
            } else {
                clearInterval(interval);
                isRunning = false;
                startBtn.textContent = 'Resume';
            }
        }

        /**
         * Resets the timer to the initial time.
         */
        function resetTimer() {
            clearInterval(interval);
            interval = null;
            isRunning = false;
            totalSeconds = INITIAL_TIME_SECONDS;
            
            updateDisplay();
            
            // Update button/message states
            startBtn.textContent = 'Start';
            startBtn.disabled = false;
            resetBtn.disabled = true;
            alarmMessageEl.style.display = 'none';
            countdownEl.style.display = 'block';
            countdownEl.classList.remove('text-orange-400');
            countdownEl.classList.add('text-white');
        }

        /**
         * Toggles the visibility of the instructions section.
         */
        function toggleInstructions() {
            const isOpen = instructionsContent.classList.toggle('open');
            toggleIcon.textContent = isOpen ? '‚ñ≤' : '‚ñº';
        }

        // Initialize the display on load
        window.onload = function() {
            updateDisplay();
        };

    </script>
</body>
</html>
